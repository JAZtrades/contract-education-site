<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Complete Your Payment</title>
  <link rel="stylesheet" href="styles.css" />
  <script defer>
    // Display appointment details and update payment status
    function loadAppointment() {
      const appointmentId = localStorage.getItem('currentAppointmentId');
      if (!appointmentId) return;
      const appointments = JSON.parse(localStorage.getItem('appointments') || '[]');
      const appt = appointments.find((a) => String(a.id) === String(appointmentId));
      if (!appt) return;
      document.getElementById('apptName').textContent = appt.name;
      document.getElementById('apptEmail').textContent = appt.email;
      document.getElementById('apptDate').textContent = new Date(appt.datetime).toLocaleString();
    }

    // Save payment status when user returns from payment link (mock example)
    function markPaid() {
      const appointmentId = localStorage.getItem('currentAppointmentId');
      const appointments = JSON.parse(localStorage.getItem('appointments') || '[]');
      const idx = appointments.findIndex((a) => String(a.id) === String(appointmentId));
      if (idx >= 0) {
        appointments[idx].status = 'Paid';
        localStorage.setItem('appointments', JSON.stringify(appointments));
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      loadAppointment();
      // check if URL contains paid flag
      if (window.location.search.includes('paid=1')) {
        markPaid();
      }
    });
  </script>
</head>
<body>
  <header>
    <div class="container">
      <h1>Complete Your Payment</h1>
      <nav>
        <a href="index.html" class="btn-secondary">Home</a>
      </nav>
    </div>
  </header>
  <main>
    <section class="payment-section">
      <div class="container">
        <h2>Your Appointment</h2>
        <p><strong>Name:</strong> <span id="apptName"></span></p>
        <p><strong>Email:</strong> <span id="apptEmail"></span></p>
        <p><strong>Date &amp; Time:</strong> <span id="apptDate"></span></p>
        <h3>Choose Payment Amount</h3>
        <form id="paymentOptions">
          <label>
            <input type="radio" name="amount" value="1250" checked />
            Deposit – $1,250
          </label><br/>
          <label>
            <input type="radio" name="amount" value="2500" />
            Pay in full – $2,500
          </label>
        </form>
        <h3>Payment Methods</h3>
        <p>Select a payment option below to complete your transaction. You will be redirected to a secure checkout page.</p>
        <!-- Placeholder payment links; replace with your own links or integrate a payment SDK -->
        <a id="payLink" class="btn-primary" href="#">Pay with Card / Apple Pay</a>
        <div class="spacer"></div>
        <div id="cashAppPlaceholder">
          <p>Cash App Pay is available through Square's Web Payments SDK. Implement it here by following the
            official documentation【523427093429045†L492-L536】.</p>
        </div>
      </div>
    </section>
  </main>
  <footer>
    <div class="container">
      <p>&copy; 2025 JAZtrades. All rights reserved.</p>
    </div>
  </footer>
  <script>
    // Set the payment link according to the selected amount (example only)
    const paymentLinks = {
  1250: 'https://buy.stripe.com/test_dR6bLT5Ckaz2fWoeVZ',
  2500: 'https://buy.stripe.com/test_8wM8zHe8Qaz2dOg8xA'
};


    function updatePayLink() {
      const amount = document.querySelector('input[name="amount"]:checked').value;
      const link = paymentLinks[amount];
      const payButton = document.getElementById('payLink');
      payButton.setAttribute('href', link || '#');
    }
    document.getElementById('paymentOptions').addEventListener('change', updatePayLink);
    updatePayLink();
  </script>
</body>
</html>
