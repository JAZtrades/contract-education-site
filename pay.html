<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Complete Your Payment</title>
  <link rel="stylesheet" href="styles.css" />
  <script defer>
    // Display appointment details and update payment status
    function loadAppointment() {
      const appointmentId = localStorage.getItem('currentAppointmentId');
      if (!appointmentId) return;
      const appointments = JSON.parse(localStorage.getItem('appointments') || '[]');
      const appt = appointments.find((a) => String(a.id) === String(appointmentId));
      if (!appt) return;
      document.getElementById('apptName').textContent = appt.name;
      document.getElementById('apptEmail').textContent = appt.email;
      document.getElementById('apptDate').textContent = new Date(appt.datetime).toLocaleString();
    }

    // Save payment status when user returns from payment link (mock example)
    function markPaid() {
      const appointmentId = localStorage.getItem('currentAppointmentId');
      const appointments = JSON.parse(localStorage.getItem('appointments') || '[]');
      const idx = appointments.findIndex((a) => String(a.id) === String(appointmentId));
      if (idx >= 0) {
        appointments[idx].status = 'Paid';
        localStorage.setItem('appointments', JSON.stringify(appointments));
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      loadAppointment();
      // check if URL contains paid flag
      if (window.location.search.includes('paid=1')) {
        markPaid();
      }
    });
  </script>
</head>
<body>
  <header>
    <div class="container">
      <h1>Complete Your Payment</h1>
      <nav>
        <a href="index.html" class="btn-secondary">Home</a>
      </nav>
    </div>
  </header>
  <main>
    <section class="payment-section">
      <div class="container">
        <h2>Your Appointment</h2>
        <p><strong>Name:</strong> <span id="apptName"></span></p>
        <p><strong>Email:</strong> <span id="apptEmail"></span></p>
        <p><strong>Date &amp; Time:</strong> <span id="apptDate"></span></p>
        <!-- Agreement section -->
        <section class="agreement-section">
          <h3>Coaching Agreement</h3>
          <div class="agreement-box">
            <p><strong>Purpose:</strong> This agreement outlines the private crypto‑coaching arrangement between CryptoBossMan, operating under the brand JAZ Trades (the "Educator"), and you (the "Client").</p>
            <p><strong>Scope of Services:</strong> The Educator will provide up to nine hours of tailored instruction. Sessions may be divided into one‑hour blocks or combined into longer sessions. The final session may extend past nine hours at the Educator’s discretion to ensure all topics are covered.</p>
            <p><strong>Delivery:</strong> Sessions are delivered via Discord, Zoom or in person as mutually agreed.</p>
            <p><strong>Fees &amp; Payment:</strong> Tuition is $2,500 USD. A $1,250 non‑refundable deposit is due before your first session, with the remaining $1,250 due before your final session.</p>
            <p><strong>Educational Content:</strong> Topics include secure storage using hardware wallets, exchange onboarding/offboarding, private keys, seed phrases and security best practices, market cycles, token categories, technical and fundamental analysis, research tools, DeFi, staking and commentary on current projects.</p>
            <p><strong>Disclaimers:</strong> All information is provided for educational purposes. The Educator is not a financial advisor, accountant or attorney. No results are guaranteed and you are solely responsible for all investment decisions. Cryptocurrency markets are speculative and volatile. Always perform your own research and consult professionals.</p>
            <p><strong>Acknowledgment:</strong> By checking the boxes below you confirm you have read, understood and agree to these terms.</p>
          </div>
          <div class="agreement-checkboxes">
            <label><input type="checkbox" id="ack1" /> I have read and agree to the coaching agreement.</label><br />
            <label><input type="checkbox" id="ack2" /> I understand this is educational information and not financial advice.</label>
          </div>
        </section>

        <h3>Choose Payment Amount</h3>
        <form id="paymentOptions">
          <label>
            <input type="radio" name="amount" value="1250" checked />
            Deposit – $1,250
          </label><br/>
          <label>
            <input type="radio" name="amount" value="2500" />
            Pay in full – $2,500
          </label>
        </form>
        <h3>Payment Methods</h3>
        <p>Select a payment option below to complete your transaction. You will be redirected to a secure checkout page.</p>
        <!-- Payment link; disabled until agreement boxes checked -->
        <a id="payLink" class="btn-primary" href="#" disabled>Pay with Card / Apple Pay</a>
        <div class="spacer"></div>
        <div id="cashAppPlaceholder">
          <p>Cash App Pay is available through Square's Web Payments SDK. Implement it here by following the
            official documentation.</p>
        </div>
      </div>
    </section>
  </main>
  <footer>
    <div class="container">
      <p>&copy; 2025 JAZtrades. All rights reserved.</p>
    </div>
  </footer>
  <script>
    // Set the payment link according to the selected amount (example only)
    // Provide test payment links using Stripe's test mode. Replace these with your
    // own live payment links when you're ready to accept real payments. See
    // https://www.cjav.dev/articles/pass-data-through-stripe-payment-links for details.
    const paymentLinks = {
      // Deposit ($1,250) – link to Square payment page
      1250: 'https://square.link/u/N4nw7soc',
      // Full payment ($2,500) – link to Square payment page
      2500: 'https://square.link/u/Fda75oDg'
    };
    function updatePayLink() {
      const amount = document.querySelector('input[name="amount"]:checked').value;
      const link = paymentLinks[amount];
      const payButton = document.getElementById('payLink');
      payButton.setAttribute('href', link || '#');
    }

    // Enable or disable the payment button based on agreement checkboxes
    function updatePayButton() {
      const payButton = document.getElementById('payLink');
      const ack1 = document.getElementById('ack1');
      const ack2 = document.getElementById('ack2');
      if (ack1 && ack2) {
        const enabled = ack1.checked && ack2.checked;
        if (enabled) {
          payButton.removeAttribute('disabled');
        } else {
          payButton.setAttribute('disabled', 'disabled');
        }
      }
    }

    document.getElementById('paymentOptions').addEventListener('change', () => {
      updatePayLink();
    });
    // Attach listeners to agreement checkboxes
    document.addEventListener('DOMContentLoaded', () => {
      const ack1 = document.getElementById('ack1');
      const ack2 = document.getElementById('ack2');
      if (ack1 && ack2) {
        ack1.addEventListener('change', updatePayButton);
        ack2.addEventListener('change', updatePayButton);
        updatePayButton();
      }
    });
    // Initialize payment link on load
    updatePayLink();
  </script>
</body>
</html>
